import"https://deno.land/x/i18next/index.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))m(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&m(f)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function m(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}})();let b;function U(d,c){b?b.setCenter([d,c]):b=new ymaps.Map("map",{center:[d,c],zoom:10})}document.querySelector('script[src="https://api-maps.yandex.ru/2.1/?apikey=83c35695-8da5-419d-81ae-38b8f3a6dcc0&lang=ru_RU"]');window.addEventListener("DOMContentLoaded",()=>{const d=document.querySelector(".weather__btns-wrapper");document.querySelector("#languageChange");const c=document.querySelector("#degree_far"),s=document.querySelector("#degree_cels"),m=document.querySelectorAll(".degree_btns"),o=document.querySelector(".weather__city"),r=document.querySelector(".weather__time-date"),f=document.querySelector(".weather__hour"),p=document.querySelector(".weather__conditions-num"),q=document.querySelector(".weather__condition-text"),a=Array.from(document.querySelectorAll("[data-daytime]")),v=document.querySelector(".windSpeed"),k=document.querySelector(".humidityNum"),h=document.querySelector(".feelsLike"),I=document.querySelector("#weather_form"),N=document.querySelector("#weather_form input"),D=document.querySelector(".latitude"),M=document.querySelector(".longitude"),E="http://api.weatherapi.com/v1/forecast.json?key=81cd96a4cf8f4303b5e111110242903&q=",y=document.querySelector(".weather__conditions-icon"),C=Array.from(document.querySelectorAll(".weather__item-icon img"));document.querySelector(".morningLang"),document.querySelector(".afterLang"),document.querySelector(".nightLang"),document.querySelector(".feelsLang"),document.querySelector(".windLang"),document.querySelector(".humidityLang");const O=()=>{function n(l){navigator.geolocation.getCurrentPosition(u=>{g(`${u.coords.latitude}, ${u.coords.longitude}`)})}function i(){alert("Unable to retrieve your location")}navigator.geolocation?navigator.geolocation.getCurrentPosition(n,i):alert("Geolocation is not supported by your browser")};d.addEventListener("click",O);function A(n){return["January","February","March","April","May","June","July","August","September","October","November","December"][n]}function P(n){const i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],l=n.split("-"),u=l[0],w=parseInt(l[1])-1,_=l[2],S=new Date(u,w,_),x=i[S.getDay()],L=A(S.getMonth());return`${x} ${_} ${L}`}function t(n){return`${n}`.length>2?`${n}`.slice(0,-2)+"°":`${n}°`}c.addEventListener("click",()=>{h.textContent=t(e.feelslike_f),p.textContent=t(e.temp_f),a[0].textContent=t(e.forecastday[0].hour[0].temp_f),a[1].textContent=t(e.forecastday[0].hour[12].temp_f),a[2].textContent=t(e.forecastday[0].hour[21].temp_f),localStorage.setItem("preferredDeg","fahr")}),s.addEventListener("click",()=>{h.textContent=t(e.feelslike_c),p.textContent=t(e.temp_c),a[0].textContent=t(e.forecastday[0].hour[0].temp_c),a[1].textContent=t(e.forecastday[0].hour[12].temp_c),a[2].textContent=t(e.forecastday[0].hour[21].temp_c),localStorage.setItem("preferredDeg","cels")}),localStorage.getItem("preferredDeg")==="fahr"?(c.checked=!0,c.classList.add("active_btn"),s.classList.remove("active_btn")):(s.checked=!0,c.classList.remove("active_btn"),s.classList.add("active_btn")),m.forEach(n=>{n.addEventListener("click",()=>{m.forEach(i=>{i!==n&&i.classList.remove("active_btn")}),n.classList.add("active_btn")})});let e={city:"Moscow",country:"Russia",feelslike_c:0,feelslike_f:0,temp_f:0,temp_c:0,wind_kph:0,humidity:0,lat:0,lon:0,localtime:0,weatherIcon:0,text:""};const g=async n=>{const l=await(await fetch(E+n)).json();let{current:{feelslike_c:u,feelslike_f:w,temp_f:_,temp_c:S,wind_kph:x,humidity:L,condition:$},location:{name:F,country:T,lat:j,lon:B,localtime:J},forecast:{forecastday:R}}=l;switch(e={...e,city:F,country:T,feelslike_c:u,feelslike_f:w,temp_f:_,temp_c:S,wind_kph:x,humidity:L,lat:j,lon:B,localtime:J,condition:$,forecastday:R},e.condition.text){case"Partly cloudy":y.src="/public/icons/partly.png";break;case"Sunny":y.src="/public/icons/sunny.png";break;case"Cloudy":y.src="/public/icons/cloud.png";break;case"Clear":y.src="/public/icons/clear.png";break;case"Mist":y.src="/public/icons/fog.png";break}C[0].src=e.forecastday[0].hour[0].condition.icon,C[1].src=e.forecastday[0].hour[12].condition.icon,C[2].src=e.forecastday[0].hour[21].condition.icon,q.textContent=e.condition.text,r.textContent=P(e.localtime.split(" ")[0]),o.textContent=e.city,D.textContent=e.lat,M.textContent=e.lon,f.textContent=e.localtime.split(" ")[1],v.textContent=e.wind_kph+" kph",k.textContent=e.humidity+"%",c.checked?(h.textContent=t(e.feelslike_f),p.textContent=t(e.temp_f),a[0].textContent=t(e.forecastday[0].hour[0].temp_f),a[1].textContent=t(e.forecastday[0].hour[12].temp_f),a[2].textContent=t(e.forecastday[0].hour[21].temp_f)):(h.textContent=t(e.feelslike_c),p.textContent=t(e.temp_c),a[0].textContent=t(e.forecastday[0].hour[0].temp_c),a[1].textContent=t(e.forecastday[0].hour[12].temp_c),a[2].textContent=t(e.forecastday[0].hour[21].temp_c)),U(e.lat,e.lon)};localStorage.getItem("lastLocation")!==""&&localStorage.getItem("lastLocation")!==null?g(localStorage.getItem("lastLocation")):g("Moscow"),I.addEventListener("submit",n=>{n.preventDefault();const i=document.getElementById("form__name").value;g(i),localStorage.setItem("lastLocation",i),N.value=""})});
